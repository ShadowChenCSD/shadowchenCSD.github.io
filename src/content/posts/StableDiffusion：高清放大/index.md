---
title: StableDiffusion：高清放大
published: 2024-11-30
description: 介绍图像高清放大技术，既包括传统的插值放大方案、通过模型进行放大的方案，也包括使用图生图进行重采样放大的方案，还有通过高清放大插件进行放大的方案。
tags: [AIGC·图像, 图像生成, StableDiffusion]
category: AIGC
image: "/posts/StableDiffusion.png"
---

# 1. 背景

​		当图像**分辨率较低**、**清晰度较差**或者**需要图像修复**时，可以使用 `高清放大` 功能，对图像进行**高清化**或者**修复**。

# 2. 插值放大

## 2.1 说明

​		直接对图像做像素间的插值，进行图像放大，其中**双线性插值**的效果相对更好。这种对图像**直接放大**的方式，**对细节几乎没有加强处理**。

## 2.2 ComfyUI

### 工作流

![插值放大](插值放大.jpg)

### 效果图

|       参考图        |          双线性插值          |
| :-----------------: | :--------------------------: |
| ![参考图](girl.jpg) | ![效果图](girl_插值放大.jpg) |

# 3. 通过模型放大

## 3.1 说明

​		[**R-ESRGAN_x4plus**](https://hf-mirror.com/epishchik/RealESRGAN_x4plus)适用于处理**需要保留丰富细节和纹理的图像**，一般用于**写实类图片**。

​		[**R-ESRGAN_x4plus_anime_6B**](https://hf-mirror.com/epishchik/RealESRGAN_x4plus_anime_6B)特别**针对动漫和二次元图像进行了优化，专门为动漫风格图像设计**，它能够**更好地处理动漫图像中的色彩、线条和细节**，一般用于**二次元类图片**或**3D渲染类图片**。

​		[**4x-UltraSharp**](https://modelscope.cn/models/XiangZL0/4x-UltraSharp/resolve/master/4x-UltraSharp.pth)可以**生成大量细节，使图像更加清晰**，并且可以**在图像上留下自然的纹理，提升图像的质感**。

## 3.2 WebUI

### 后期处理模块

![R-ESRGAN_4x+](后期处理：R-ESRGAN_4x+.jpg)

### 效果图

|       参考图        |            R-ESRGAN_x4plus             |
| :-----------------: | :------------------------------------: |
| ![参考图](girl.jpg) | ![效果图](girl_R-ESRGAN_4x+_WebUI.jpg) |

## 3.3 ComfyUI

### 模型存放位置

`comfyUI\models\upscale_models`

### 工作流

![R-ESRGAN_x4plus](模型放大：R-ESRGAN_x4plus.jpg)

![4x-UltraSharp](模型放大：4x-UltraSharp.jpg)

### 效果图

|       参考图        |               R-ESRGAN_x4plus               |               4x-UltraSharp               |
| :-----------------: | :-----------------------------------------: | :---------------------------------------: |
| ![参考图](girl.jpg) | ![效果图](girl_R-ESRGAN_x4plus_ComfyUI.jpg) | ![效果图](girl_4x-UltraSharp_ComfyUI.jpg) |

# 4. 重采样放大

​		结合**放大模型**和**生图模型**，对原始图像进行**重新采样**，添加细节，实现**高清放大**。

​		在**放大阶段**，可以**使用latent直接放大**，也可以**使用模型进行放大**。

## 4.1 WebUI

### 图生图模块

![重采样放大](图生图：重采样放大.jpg)

### 效果图

|       参考图        |         FLUX模型：重采样放大         |
| :-----------------: | :----------------------------------: |
| ![参考图](girl.jpg) | ![效果图](girl_重采样放大_WebUI.jpg) |


## 4.2 ComfyUI：Latent放大

### 工作流

​		建议**去噪程度**在**0.4左右**。

- **SD 1.5**

![重采样放大：Latent放大](重采样放大_Latent放大_SD1.5.jpg)

- **SDXL**

![重采样放大：Latent放大](重采样放大_Latent放大_SDXL.jpg)

- **FLUX**

![重采样放大：Latent放大](重采样放大_Latent放大_FLUX.jpg)

### 效果图

|             一次采样              |         重采样放大：Latent放大         |
| :-------------------------------: | :------------------------------------: |
| ![一次采样](一次采样：SD1.5.jpg)  | ![重采样放大](重采样放大：SD1.5-1.jpg) |
|  ![一次采样](一次采样：SDXL.jpg)  | ![重采样放大](重采样放大：SDXL-1.jpg)  |
| ![一次采样](一次采样：FLUX-1.jpg) | ![重采样放大](重采样放大：FLUX-1.jpg)  |
| ![一次采样](一次采样：FLUX-2.jpg) | ![重采样放大](重采样放大：FLUX-2.jpg)  |


## 4.3 ComfyUI：模型放大

### 工作流

​		建议**去噪程度**在**0.4左右**。

- **SD 1.5**

![重采样放大：模型放大](重采样放大_模型放大_SD1.5.jpg)

- **SDXL**

![重采样放大：模型放大](重采样放大_模型放大_SDXL.jpg)

- **FLUX**

![重采样放大：模型放大](重采样放大_模型放大_FLUX.jpg)

### 效果图

|             一次采样              |  重采样放大：模型放大，预览缩放：50%   |
| :-------------------------------: | :------------------------------------: |
| ![一次采样](一次采样：SD1.5.jpg)  | ![重采样放大](重采样放大：SD1.5-2.jpg) |
|  ![一次采样](一次采样：SDXL.jpg)  | ![重采样放大](重采样放大：SDXL-2.jpg)  |
| ![一次采样](一次采样：FLUX-1.jpg) | ![重采样放大](重采样放大：FLUX-3.jpg)  |
| ![一次采样](一次采样：FLUX-2.jpg) | ![重采样放大](重采样放大：FLUX-4.jpg)  |

# 5. 放大插件：SUPIR

## 5.1 说明：SDXL模型

​		**SUPIR**旨在用于**照片级真实感的图像恢复**，图像细节增加效果显著。

- **节点安装**：[ComfyUI-SUPIR](https://github.com/kijai/ComfyUI-SUPIR.git)

- **生图模型**：**SDXL系列**的**base**模型

- **模型下载地址**

  - [SUPIR-v0Q.ckpt](https://modelscope.cn/models/gakaki/SUPIR/resolve/master/SUPIR-v0Q.ckpt)：**精度更高**

  - [SUPIR-v0F.ckpt](https://modelscope.cn/models/gakaki/SUPIR/resolve/master/SUPIR-v0F.ckpt)：**速度更快**

- **模型存放位置**：`comfyUI\models\checkpoints`

## 5.2 示例

### 工作流

![SUPIR](SUPIR.jpg)

### 效果图

|       参考图        |           SUPIR           |
| :-----------------: | :-----------------------: |
| ![参考图](girl.jpg) | ![效果图](girl_SUPIR.jpg) |

# 6. 放大插件：Flux-ControlNet-Upscaler

## 6.1 说明：FLUX模型

​		被Xlabs收购的**Jasper AI团队**，发布了**基于Flux.1-dev的ControlNet插件**，可以**实现图像放大功能**。

- **模型下载地址**：[**JasperAI-ControlNet-UpScaler**](https://hf-mirror.com/jasperai/Flux.1-dev-Controlnet-Upscaler/resolve/main/diffusion_pytorch_model.safetensors)
- **模型存放位置**：`comfyUI\models\controlnet`

## 6.2 示例

### 工作流

![Flux.1-ControlNet-Upscaler](ControlNet-Upscaler.jpg)

### 效果图

|       参考图        |           ControlNet-UpScaler           |
| :-----------------: | :-------------------------------------: |
| ![参考图](girl.jpg) | ![效果图](girl_ControlNet-Upscaler.jpg) |

# 7. 饰品精修

## 7.1 工作流

![饰品精修](饰品精修.jpg)

## 7.2 效果图

| 原始图像：311 * 309 |     一阶段：616 * 616     |     二阶段：924 * 924     |
| :-----------------: | :-----------------------: | :-----------------------: |
| ![原图](饰品-1.jpg) | ![精修图-1](精修图-1.jpg) | ![精修图-2](精修图-2.jpg) |

| 原始图像：768 * 768 | 一阶段：1536 * 1536 | 二阶段：2304 * 2304 |
|:-----------------:|:-----------------:|:-----------------:|
| ![原图](饰品-2.jpg) | ![精修图-3](精修图-3.jpg) | ![精修图-4](精修图-4.jpg) |

| 原始图像：320 * 296 | 一阶段：640 * 592 | 二阶段：960 * 888 |
|:-----------------:|:---------------:|:---------------:|
| ![原图](饰品-3.jpg) | ![精修图-5](精修图-5.jpg) | ![精修图-6](精修图-6.jpg) |

## 7.3 结论

- **优点**：
  - 可以对**低分辨率图**作**高清化放大**，增强图像细节
  - 可以**根据成像效果**，决定使用**2倍放大**还是**3倍放大**

- **缺点**：
  - 由于AI生成图像具有**随机性**，因此生成的图像和原始图像**在外形上会略有不同**
  - **AI生成时间依赖原始图像大小**
    - **300\*300**分辨率的原始图像，生成高清图像，耗时**约50秒**（RTX 4090）
    - **768\*768**分辨率的原始图像，生成高清图像，耗时**约270秒**（RTX 4090）